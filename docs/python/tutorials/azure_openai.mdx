---
title: Azure OpenAI
description: ""
---

## Adding Nebuly to your OpenAI project.
Below is an example of a project that utilizes the Python openai library to generate an image from an audio file, employing three distinct openai APIs. The code initializes "nebuly" at the beginning while leaving the remaining code unchanged.

```python
import os

import nebuly
import openai

# initialize nebuly -- No more code is added
nebuly.api_key = os.getenv("NEBULY_API_KEY")
nebuly.init(
    project="my_audio_to_image_tool",
    phase=nebuly.DevelopmentPhase.EXPERIMENTATION,
)

# openai Key
openai.api_type = "azure"
openai.api_version = "2023-05-15" 
openai.api_base = os.getenv("OPENAI_API_BASE")
openai.api_key = os.getenv("OPENAI_API_KEY")

# convert text from Audio File
audio_file = open("./my_audio_description.mp3", "rb")
response = openai.Audio.transcribe(model="whisper-1", file=audio_file)

# process the text
audio_text = response["text"]
my_prompt = f"From the following text create a clear image description:\n {audio_text}"
response = openai.Completion.create(
    model="text-davinci-003",
    prompt=my_prompt,
    max_tokens=200,
)

# create an image
my_image_description = response["choices"][0]["text"]
response = openai.Image.create(
  prompt=my_image_description,
  size="1024x1024"
)

# print my output
print(response["data"][0])

```

Running the code the output will be
```shell
{
  "url": "https://oaidalleapiprodscus.blob.core.windows.net/private/org-uatESKrY86f7lQPIt4FJxSrt/user-58FoBm5h5ymgqr593wL8TBdk/img-UGiCrXc1yAIHJoIgwtT2Ui7u.png?st=2023-05-24T07%3A39%3A23Z&se=2023-05-24T09%3A39%3A23Z&sp=r&sv=2021-08-06&sr=b&rscd=inline&rsct=image/png&skoid=6aaadede-4fb3-4698-a8f6-684d7786b067&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2023-05-24T00%3A07%3A35Z&ske=2023-05-25T00%3A07%3A35Z&sks=b&skv=2021-08-06&sig=7xeVMYG7esbdn9Z5IOFnayx9/wq5wD2Q3kNrcrHYILs%7D"
}
```

## What is Happened
In the background nebuly has tracked three records:

<CodeGroup>
    ```json Record 1
    {
        "kind": "azure_openai",
        "body": {
            "project": "my_audio_to_image_tool",
            "phase": "experimentation",
            "task": "audio_transcription",
            "timestamp": 1684910355.08503,
            "timestamp_end": 1684910356.135717,
            "api_type": "audio_transcribe",
            "api_key": "*********************",
            "timestamp_openai": null,
            "model": "whisper-1",
            "n_prompt_tokens": null,
            "n_output_tokens": null,
            "n_output_images": null,
            "image_size": null,
            "audio_duration_seconds": 21,
            "training_file_id": null,
            "training_id": null
        }
    }
    ```

    ```json Record 2
    {
        "kind": "azure_openai",
        "body": {
            "project": "my_audio_to_image_tool",
            "phase": "experimentation",
            "task": "text_generation",
            "timestamp": 1684910356.135919,
            "timestamp_end": 1684910357.77841,
            "api_type": "text_completion",
            "api_key": "*********************",
            "timestamp_openai": 1684917556,
            "model": "text-davinci-003",
            "n_prompt_tokens": 88,
            "n_output_tokens": 57,
            "n_output_images": null,
            "image_size": null,
            "audio_duration_seconds": null,
            "training_file_id": null,
            "training_id": null
        }
    }
    ```

    ```json Record 3
    {
        "kind": "azure_openai",
        "body": {
            "project": "my_audio_to_image_tool",
            "phase": "experimentation",
            "task": "image_generation",
            "timestamp": 1684910357.778747,
            "timestamp_end": 1684910363.493522,
            "api_type": "image_create",
            "api_key": "*********************",
            "timestamp_openai": 1684917563,
            "model": "dall-e",
            "n_prompt_tokens": null,
            "n_output_tokens": null,
            "n_output_images": null,
            "image_size": "1024x1024",
            "audio_duration_seconds": null,
            "training_file_id": null,
            "training_id": null
        }
    }
    ```
</CodeGroup>
